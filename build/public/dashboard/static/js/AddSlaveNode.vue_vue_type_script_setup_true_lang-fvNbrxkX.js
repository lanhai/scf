/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-09-29 00:54:07 
 */
import{$ as _}from"./http-iXKAqBkH.js";import{p as v,l as E}from"./index-D_bzg7AJ.js";import{d as $,r,f as h,S as C,o as N,T as o,b as B,Z as l,ah as F,u as a,aj as I,ax as S,ak as T,ad as U,ac as b,i as A,Q as j}from"./vsv-element-plus-Cu8LirE2.js";const q={style:{"padding-bottom":"20px"}},R=$({name:"AddSlaveNode",__name:"AddSlaveNode",setup(D,{expose:g}){const n=r(!1),d=r(!1),V=h({host:[{required:!0,trigger:"blur",message:"主机地址不能为空"}]}),t=r({host:"",port:""}),y=()=>{t.value.host="http://",n.value=!0},u=async()=>{d.value=!0;const{data:p}=await _.post("/check_slave_node",v(t.value));parseInt(p)===1?(d.value=!1,n.value=!1,E("子节点添加成功","success","hey")):setTimeout(()=>{u()},1e3)},x=async()=>{d.value=!0,await _.post("/install_slave_node",v(t.value)).finally(()=>{d.value=!1}),await u()};return g({show:y}),(p,e)=>{const m=T,i=S,f=I,k=F,c=U,w=j;return N(),C(w,{modelValue:a(n),"onUpdate:modelValue":e[4]||(e[4]=s=>A(n)?n.value=s:null),"append-to-body":"",draggable:"",title:"添加节点",width:"40%","close-on-click-modal":!1,"destroy-on-close":!0,"close-on-press-escape":!1},{footer:o(()=>[l(c,{onClick:e[2]||(e[2]=s=>n.value=!1)},{default:o(()=>e[5]||(e[5]=[b("取 消")])),_:1}),l(c,{type:"primary",onClick:e[3]||(e[3]=s=>x()),loading:a(d)},{default:o(()=>e[6]||(e[6]=[b("添 加")])),_:1},8,["loading"])]),default:o(()=>[B("div",q,[l(k,{model:a(t),rules:a(V),"status-icon":"",ref:"addForm","label-width":"120px",class:""},{default:o(()=>[l(f,{label:"主机地址：",prop:"rules"},{default:o(()=>[l(i,{span:16},{default:o(()=>[l(m,{type:"text",placeholder:"从节点的内网地址",modelValue:a(t).host,"onUpdate:modelValue":e[0]||(e[0]=s=>a(t).host=s)},null,8,["modelValue"])]),_:1})]),_:1}),l(f,{label:"主机端口：",prop:"port"},{default:o(()=>[l(i,{span:10},{default:o(()=>[l(m,{type:"number",placeholder:"通常为9580,域名可留空",modelValue:a(t).port,"onUpdate:modelValue":e[1]||(e[1]=s=>a(t).port=s)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["model","rules"])])]),_:1},8,["modelValue"])}}});export{R as _};
