/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-12-14 12:58:15 
 */
import{_ as A}from"./DatePicker.vue_vue_type_script_setup_true_lang-qwdLkDCB.js";import{$ as J}from"./http-LVUJO5_z.js";import{J as j}from"./vue-json-viewer-DM_rPkw2.js";import{d as I,r as d,f as K,ab as P,R,a as u,o,b as s,ac as w,Z as _,Y as l,u as a,S as r,X as y,av as U,T as m,a2 as f,ao as x,b3 as X,aL as Z,ay as G,b4 as H,aK as O}from"./vsv-element-plus-uCf0_uY0.js";const Q={class:"drawer-header"},W={class:"drawer-title"},ee={class:"drawer-filter"},te={style:{"padding-bottom":"20px"}},ae={style:{"max-height":"calc(100vh - 160px)","overflow-y":"auto","overflow-x":"hidden"}},oe={class:"mt-10"},ce=I({name:"AppLogs",__name:"AppLogs",props:{type:{type:String,default:"info"}},setup(C){const g=C,c=d([]),h=d(!0),z=d("total, sizes, prev, pager, next, jumper"),v=d(0),E={info:"信息日志",warn:"警告日志",error:"错误日志",debug:"调试日志",slow:"慢日志"},t=K({page:1,size:10,type:"",day:Math.floor(Date.now()/1e3)}),V=n=>{t.page=1,t.size=n,i()},$=n=>{t.page=n,i()},i=async()=>{h.value=!0,t.type=g.type;const{data:n}=await J.get("/logs",t).finally(()=>{h.value=!1});c.value=n.list,v.value=n.total},k=async()=>{t.page=1,await i()};return P(async()=>{await i()}),(n,b)=>{const D=R("vab-icon"),L=A,S=U,B=G,T=Z,Y=X,M=H,N=O;return o(),u(f,null,[s("div",Q,[s("h4",W,[w(l(E[String(g.type)])+" ",1),_(D,{icon:"refresh-line",onClick:k})]),s("div",ee,[_(L,{modelValue:a(t).day,"onUpdate:modelValue":b[0]||(b[0]=e=>a(t).day=e),placeholder:"选择日期",format:"YYYY-MM-DD",onChange:k},null,8,["modelValue"])])]),s("div",te,[s("div",ae,[a(c).length?y("",!0):(o(),r(S,{key:0,"image-size":150,description:"暂无运行日志"})),a(c).length?(o(),r(M,{key:1},{default:m(()=>[(o(!0),u(f,null,x(a(c),(e,F)=>(o(),r(Y,{placement:"top",timestamp:`${e.time||e.date}@${e.host||"master"}`,key:F},{default:m(()=>[_(T,null,{default:m(()=>[s("h4",null,l(e.module||"File")+":"+l(e.file||"--"),1),s("p",oe,[g.type==="slow"?(o(),r(a(j),{key:0,value:e.message,"expand-depth":10,copyable:"",expanded:""},null,8,["value"])):(o(),r(B,{key:1,type:e.backtrace!==void 0?"danger":"info",closable:!1},{default:m(()=>[w(l(e.message),1)]),_:2},1032,["type"]))]),e.backtrace!==void 0&&e.backtrace.length>0?(o(!0),u(f,{key:0},x(e.backtrace,(p,q)=>(o(),u("p",{style:{"margin-top":"5px","word-break":"break-all"},key:q},l(`${p.file||p.class}:${p.line||p.function}`),1))),128)):y("",!0)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):y("",!0)]),_(N,{background:"","current-page":a(t).page,layout:a(z),"page-size":a(t).size,total:a(v),onCurrentChange:$,onSizeChange:V},null,8,["current-page","layout","page-size","total"])])],64)}}});export{ce as _};
