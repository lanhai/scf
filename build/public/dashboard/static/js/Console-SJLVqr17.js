/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-09-22 18:22:00 
 */
import{d as I,r as d,c as U,w,k as b,C as $,N as j,a as x,o,b as T,Z as f,T as r,bl as z,a2 as k,ap as E,S as p,bm as F,X as M,bh as W,bi as X,at as Y,aD as Z,ac as C,Y as L,bj as q,ad as G}from"./vsv-element-plus-Cu8LirE2.js";import{_ as J}from"./index-BeqTQKfk.js";import"./vsv-icon-DxrXNnxK.js";import"./vsv-nprogress-D-M_H-zP.js";const K={class:"drawer-header"},P=20,Q=I({name:"Console",__name:"Console",props:{logs:{type:Array,default:()=>[]},nodes:{type:Array,default:()=>[]}},setup(h){const m=h,c=d(""),n=U(()=>c.value?(m.logs||[]).filter(e=>(e.node||"master")===c.value):m.logs),s=d(null),u=d(!0),v=d(n.value?n.value.length:0),a=d(0);function B(e){return e.scrollHeight-e.scrollTop-e.clientHeight<=P}function H(){const e=s.value;e&&(u.value=B(e),u.value&&(a.value=0))}function S(){const e=s.value;e&&(e.scrollTo({top:e.scrollHeight,behavior:"smooth"}),u.value=!0,a.value=0)}const A=w(n,async e=>{await b();const l=s.value;if(!l)return;const i=Array.isArray(e)?e.length:0,g=v.value||0,_=i-g;_>0&&(u.value?(l.scrollTo({top:l.scrollHeight,behavior:"smooth"}),a.value=0):a.value+=_),v.value=i},{deep:!0});return w(()=>c,()=>{v.value=n.value?n.value.length:0,a.value=0,u.value=!0,b(()=>{const e=s.value;e&&e.scrollTo({top:e.scrollHeight,behavior:"auto"})})}),$(async()=>{await b();const e=s.value;e&&(e.scrollTo({top:e.scrollHeight,behavior:"auto"}),v.value=Array.isArray(m.logs)?m.logs.length:0)}),j(()=>{A()}),(e,l)=>{const i=z,g=F,_=W,V=Z,N=Y,R=X,D=q,O=G;return o(),x(k,null,[T("div",K,[l[1]||(l[1]=T("h4",{class:"drawer-title"},"控制台日志",-1)),f(g,{class:"drawer-filter",placeholder:"所有节点",modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=t=>c.value=t),clearable:"",style:{width:"200px"}},{default:r(()=>[f(i,{label:"全部节点",value:""}),(o(!0),x(k,null,E(h.nodes,(t,y)=>(o(),p(i,{key:y,label:t.role==="master"?"主节点":t.ip,value:t.role==="master"?"master":t.ip},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),T("div",{ref_key:"containerRef",ref:s,style:{"padding-bottom":"10px","max-height":"calc(100vh - 90px)","overflow-y":"auto","overflow-x":"hidden",position:"relative"},onScroll:H},[h.logs.length?(o(),p(D,{key:1},{default:r(()=>[(o(!0),x(k,null,E(n.value,(t,y)=>(o(),p(R,{placement:"top",timestamp:`${t.time}@${t.node||"master"}`,key:y},{default:r(()=>[f(N,null,{default:r(()=>[f(V,null,{default:r(()=>[C(L(t.message.data),1)]),_:2},1024)]),_:2},1024)]),_:2},1032,["timestamp"]))),128))]),_:1})):(o(),p(_,{key:0,"image-size":150,description:"暂无日志"})),a.value>0?(o(),p(O,{key:2,class:"scroll-bottom-btn",type:"primary",onClick:S},{default:r(()=>[C(L(a.value)+" 条新日志，回到底部 ",1)]),_:1})):M("",!0)],544)],64)}}}),ae=J(Q,[["__scopeId","data-v-cdbaed3f"]]);export{ae as default};
