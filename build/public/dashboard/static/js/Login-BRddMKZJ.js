/*!  build: Vue Shop Vite 
     copyright: https://vuejs-core.cn/shop-vite   
     time: 2025-09-25 02:10:46 
 */
import C from"./LoginContainer-BCR4OCaN.js";import{d as F,r,f as v,ab as M,F as N,S as w,T as n,R as T,ag as U,o as g,b as c,Z as u,u as t,ah as A,ai as O,U as W,Y as f,aj as j,ak as Y,ad as Z,ac as z}from"./vsv-element-plus-Cu8LirE2.js";import{$ as h,l as G}from"./storage-D_topuDp.js";import{u as H,a as J,s as K,b as Q,o as X,i as ee,t as p,c as te,_ as oe}from"./index-OBT2v08I.js";import{$ as se}from"./http-Bm6VelzB.js";import"./bing-BcM1GdLz.js";import"./vsv-icon-DxrXNnxK.js";import"./vsv-nprogress-D-M_H-zP.js";const ae={class:"login-form"},re=["src"],ne={class:"title-tips"},le=F({name:"Login",__name:"Login",setup(ie){const m=te(),_=Q(),y=H(),R=J(),{title:S}=K(R),b=o=>y.login(o),l=r(!1),i=r(void 0);r("https://www.oschina.net/action/user/captcha");const d=r(),k=r(),a=v({password:h.get("_PASSWORD_")||""}),x=v({password:[{required:!0,trigger:"blur",validator:(o,e,s)=>{ee(e)?s():s(new Error(p("密码不能少于6位")))}}]}),B=()=>i.value==="/404"||i.value==="/403"?"/":i.value,E=async()=>{var o;d.value&&((o=d.value)==null||o.validate(async e=>{if(e)try{l.value=!0,h.set("_PASSWORD_",a.password),await b({password:a.password}).catch(()=>{l.value=!1}),await _.push(B())}finally{l.value=!1}}))};return M(async()=>{const{data:o}=await se.get("/install_check",{timeout:12e4});parseInt(o)===0&&_.push({path:"/install",replace:!0}).then(()=>{})}),N(()=>{i.value=m.query&&m.query.redirect||"/"}),X((o,e,s)=>{s()}),(o,e)=>{const s=T("vab-icon"),V=Y,D=j,I=Z,L=A,P=C,$=U("throttle");return g(),w(P,null,{default:n(()=>[c("div",ae,[c("img",{alt:"",class:"left-img",src:t(G)},null,8,re),u(L,{ref_key:"formRef",ref:d,"label-position":"left",model:t(a),rules:t(x),onSubmit:e[1]||(e[1]=O(()=>{},["prevent"]))},{default:n(()=>[e[2]||(e[2]=c("div",{class:"title"},"hello !",-1)),c("div",ne,f(t(p)("欢迎来到"))+" "+f(t(S)),1),u(D,{prop:"password"},{default:n(()=>[u(V,{ref_key:"passwordRef",ref:k,modelValue:t(a).password,"onUpdate:modelValue":e[0]||(e[0]=q=>t(a).password=q),modelModifiers:{trim:!0},clearable:"",placeholder:t(p)("输入管理秘钥"),"show-password":"",type:"password",autocomplete:"off",rows:3},{prefix:n(()=>[u(s,{icon:"lock-line"})]),_:1},8,["modelValue","placeholder"])]),_:1}),W((g(),w(I,{class:"login-btn",loading:t(l),type:"primary"},{default:n(()=>[z(f(t(p)("登录")),1)]),_:1},8,["loading"])),[[$,E]])]),_:1},8,["model","rules"])])]),_:1})}}}),ge=oe(le,[["__scopeId","data-v-86c3b669"]]);export{ge as default};
