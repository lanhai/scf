{"version":3,"sources":["webpack:///./src/views/Install.vue?39e8","webpack:///src/views/Install.vue","webpack:///./src/views/Install.vue?8156","webpack:///./src/views/Install.vue"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","attrs","span","placeholder","prefix-icon","type","rows","model","value","input","callback","$$v","$set","expression","loading","isLoading","on","click","$event","install","_s","text","staticRenderFns","Installvue_type_script_lang_js_","name","data","key","$cookie","get","password","methods","_this","$request","post","$copy","then","result","errCode","$router","push","$message","error","message","set","check","catch","copy","url","oInput","document","createElement","body","appendChild","select","execCommand","success","remove","_this2","timeout","alert","title","content","concat","confirmButtonText","setTimeout","window","location","reload","console","warn","views_Installvue_type_script_lang_js_","component","Object","componentNormalizer","__webpack_exports__"],"mappings":"uHAAA,IAAAA,EAAA,WAA0B,IAAAC,EAAAC,KAAaC,EAAAF,EAAAG,eAA0BC,EAAAJ,EAAAK,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAiBE,YAAA,SAAoB,CAAAF,EAAA,OAAYE,YAAA,aAAwB,CAAAF,EAAA,KAAUE,YAAA,0BAAqC,CAAAN,EAAAO,GAAA,cAAAH,EAAA,OAAiCE,YAAA,YAAuB,CAAAF,EAAA,OAAAA,EAAA,UAAyBI,MAAA,CAAOC,KAAA,KAAW,CAAAL,EAAA,YAAiBI,MAAA,CAAOE,YAAA,UAAAC,cAAA,cAAAC,KAAA,WAAAC,KAAA,IAAgFC,MAAA,CAAQC,MAAAf,EAAAgB,MAAA,IAAAC,SAAA,SAAAC,GAA+ClB,EAAAmB,KAAAnB,EAAAgB,MAAA,MAAAE,IAAgCE,WAAA,gBAAyB,GAAAhB,EAAA,UAAmBE,YAAA,QAAAE,MAAA,CAA2BC,KAAA,KAAW,CAAAL,EAAA,aAAkBE,YAAA,eAAAE,MAAA,CAAkCI,KAAA,UAAAS,QAAArB,EAAAsB,WAAyCC,GAAA,CAAKC,MAAA,SAAAC,GAAyB,OAAAzB,EAAA0B,aAAuB,CAAA1B,EAAAO,GAAAP,EAAA2B,GAAA3B,EAAA4B,UAAA,cACvtBC,EAAA,GCkBeC,EAAA,CACfC,KAAA,UACAC,KAAA,WACA,OACAV,WAAA,EACAM,KAAA,KACAZ,MAAA,CACAiB,IAAAhC,KAAAiC,QAAAC,IAAA,gCAEAC,SAAA,KAGAC,QAAA,CACAX,QAAA,eAAAY,EAAArC,KAEAA,KAAAqB,WAAA,EACArB,KAAAsC,SAAAC,KAAA,WAAAvC,KAAAwC,MAAAxC,KAAAe,QAAA0B,MAAA,SAAAC,GACA,GAAAA,EAAAC,QAAA,CACA,qBAAAD,EAAAC,QAEA,YADAN,EAAAO,QAAAC,KAAA,UAGAR,EAAAS,SAAAC,MAAAL,EAAAM,SACAX,EAAAhB,WAAA,OAEAgB,EAAAJ,QAAAgB,IAAA,0BAAAZ,EAAAtB,MAAAiB,KACAK,EAAAV,KAAA,SACAU,EAAAa,QACAb,EAAAF,SAAAO,EAAAX,KAAAI,SACAE,EAAAJ,QAAAgB,IAAA,uBAAAZ,EAAAF,aAEAgB,OAAA,SAAAJ,GACAV,EAAAS,SAAAC,aAGAK,KAAA,SAAArB,GACA,IAAAsB,EAAAtB,EACAuB,EAAAC,SAAAC,cAAA,SACAF,EAAAxC,MAAAuC,EACAE,SAAAE,KAAAC,YAAAJ,GACAA,EAAAK,SACAJ,SAAAK,YAAA,QACA5D,KAAA8C,SAAAe,QAAA,qBACAP,EAAAQ,UAEAZ,MAAA,eAAAa,EAAA/D,KACAA,KAAAsC,SAAAJ,IAAA,UAAA8B,QAAA,MAAAvB,MAAA,SAAAC,GACA,wBAAAA,EAAAC,SACAoB,EAAA1C,WAAA,EACA0C,EAAAjB,SAAAmB,MAAA,CACAC,MAAA,sBACAC,QAAA,WAAAC,OAAAL,EAAA5B,SAAA,aACAkC,kBAAA,SACA,WACAN,EAAAX,KAAAW,EAAA5B,UACA4B,EAAAnB,QAAAC,KAAA,UACAyB,YAAA,WACAC,OAAAC,SAAAC,WACA,SAIAH,YAAA,WACAP,EAAAb,UACA,QAEAC,OAAA,SAAAJ,GACA2B,QAAAC,KAAA5B,GACAuB,YAAA,WACAP,EAAAb,UACA,WCzFiV0B,EAAA,cCOjVC,EAAgBC,OAAAC,EAAA,KAAAD,CACdF,EACA9E,EACA8B,GACF,EACA,KACA,WACA,MAIeoD,EAAA,WAAAH","file":"js/chunk-2d0e5f4f.37d2ca0a.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"login\"},[_c('div',{staticClass:\"login-con\"},[_c('p',{staticClass:\"c-FE mt-15 fs-16 mb-20\"},[_vm._v(\"SCF·应用安装\")]),_c('div',{staticClass:\"width374\"},[_c('div',[_c('el-col',{attrs:{\"span\":24}},[_c('el-input',{attrs:{\"placeholder\":\"请输入安装秘钥\",\"prefix-icon\":\"el-icon-key\",\"type\":\"textarea\",\"rows\":12},model:{value:(_vm.input.key),callback:function ($$v) {_vm.$set(_vm.input, \"key\", $$v)},expression:\"input.key\"}})],1),_c('el-col',{staticClass:\"mt-10\",attrs:{\"span\":24}},[_c('el-button',{staticClass:\"login-button\",attrs:{\"type\":\"primary\",\"loading\":_vm.isLoading},on:{\"click\":function($event){return _vm.install()}}},[_vm._v(_vm._s(_vm.text))])],1)],1)])])])}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n    <div class=\"login\">\n        <div class=\"login-con\">\n            <p class=\"c-FE mt-15 fs-16 mb-20\">SCF·应用安装</p>\n            <div class=\"width374\">\n                <div>\n                    <el-col :span=\"24\">\n                        <el-input placeholder=\"请输入安装秘钥\" prefix-icon=\"el-icon-key\" v-model=\"input.key\" type=\"textarea\" :rows=\"12\"></el-input>\n                    </el-col>\n                    <el-col :span=\"24\" class=\"mt-10\">\n                        <el-button type=\"primary\" v-on:click=\"install()\" :loading=\"isLoading\" class=\"login-button\">{{ text }}</el-button>\n                    </el-col>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\nexport default {\n    name: \"Install\",\n    data() {\n        return {\n            isLoading: false,\n            text: '安装',\n            input: {\n                key: this.$cookie.get('_DASHBOARD_INSTALL_KEY_') || ''\n            },\n            password: ''\n        }\n    },\n    methods: {\n        install() {\n\n            this.isLoading = true;\n            this.$request.post('/install', this.$copy(this.input)).then(result => {\n                if (result.errCode) {\n                    if (result.errCode === 'APP_INSTALLED') {\n                        this.$router.push('/login')\n                        return\n                    }\n                    this.$message.error(result.message);\n                    this.isLoading = false;\n                } else {\n                    this.$cookie.set('_DASHBOARD_INSTALL_KEY_', this.input.key)\n                    this.text = '等待安装完成'\n                    this.check()\n                    this.password = result.data.password\n                    this.$cookie.set('_DASHBOARD_PASSWORD_', this.password)\n                }\n            }).catch(error => {\n                this.$message.error(error);\n            });\n        },\n        copy(data) {\n            let url = data;\n            let oInput = document.createElement('input');\n            oInput.value = url;\n            document.body.appendChild(oInput);\n            oInput.select(); // 选择对象;\n            document.execCommand(\"Copy\"); // 执行浏览器复制命令\n            this.$message.success('管理密码已复制到粘贴板,清妥善保存')\n            oInput.remove()\n        },\n        check() {\n            this.$request.get('/check', {timeout: 3000}).then(result => {\n                if (result.errCode !== 'APP_NOT_INSTALL_YET') {\n                    this.isLoading = false;\n                    this.$message.alert({\n                        title: '安装完成,清使用以下密码登录仪表盘管理',\n                        content: `<strong>${this.password}</strong>`,\n                        confirmButtonText: '复制密码'\n                    }, () => {\n                        this.copy(this.password)\n                        this.$router.push('/login')\n                        setTimeout(() => {\n                            window.location.reload()\n                        }, 2000)\n                    })\n\n                } else {\n                    setTimeout(() => {\n                        this.check()\n                    }, 1000)\n                }\n            }).catch(error => {\n                console.warn(error);\n                setTimeout(() => {\n                    this.check()\n                }, 1000)\n            });\n        }\n    }\n}\n</script>\n\n<style scoped>\n\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Install.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Install.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Install.vue?vue&type=template&id=8ab1d70e&scoped=true&\"\nimport script from \"./Install.vue?vue&type=script&lang=js&\"\nexport * from \"./Install.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8ab1d70e\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}